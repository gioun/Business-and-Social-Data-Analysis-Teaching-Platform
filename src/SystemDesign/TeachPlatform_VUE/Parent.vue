<template>
    <a-layout class="layout">
        <a-layout-header v-if="true" >
        
            <div class="logo" >
                
            </div>
            <!-- è·³è½¬æ¡† -->
            <a-menu
                v-model:selectedKeys="selectedKeys"
                theme="dark"
                mode="horizontal"
                :style="{ lineHeight: '64px', }"
                @select="ToPage"
                
            >
                <a-menu-item key="Index" > <img src="./img/Icon4.png" alt="logo" width="300" height="50"> </a-menu-item>
                <a-menu-item key="Account" title="ä¸ªäººå¸æˆ·">ä¸ªäººå¸æˆ·</a-menu-item>
                <a-menu-item key="CourseManagement" title="è¯¾ç¨‹ç®¡ç†">è¯¾ç¨‹ç®¡ç†</a-menu-item>
                <a-menu-item key="Homework" title="ä½œä¸šæµ‹è¯•">ä½œä¸šæµ‹è¯•</a-menu-item>
                <a-menu-item key="Community" title="åŒ¿åç¤¾åŒº">åŒ¿åç¤¾åŒº</a-menu-item>
                <a-menu-item key="Resource" title="èµ„æºè®¿é—®">èµ„æºè®¿é—®</a-menu-item>
                
            </a-menu>
        </a-layout-header>



        <!-- <a-layout>
        
            <a-layout-sider width="200" style="background: #fff" >
                <a-menu
                    v-model:selectedKeys="selectedKeys2"
                    v-model:openKeys="openKeys"
                    mode="inline"
                    :style="{ height: '100%', borderRight: 0 }"
                >
                    <a-sub-menu key="sub1">
                    <template #title>
                        <span>
                        <user-outlined />
                        subnav 1
                        </span>
                    </template>
                    <a-menu-item key="1">option1</a-menu-item>
                    <a-menu-item key="2">option2</a-menu-item>
                    <a-menu-item key="3">option3</a-menu-item>
                    <a-menu-item key="4">option4</a-menu-item>
                    </a-sub-menu>
                    <a-sub-menu key="sub2">
                    <template #title>
                        <span>
                        <laptop-outlined />
                        subnav 2
                        </span>
                    </template>
                    <a-menu-item key="5">option5</a-menu-item>
                    <a-menu-item key="6">option6</a-menu-item>
                    <a-menu-item key="7">option7</a-menu-item>
                    <a-menu-item key="8">option8</a-menu-item>
                    </a-sub-menu>
                    <a-sub-menu key="sub3">
                    <template #title>
                        <span>
                        <notification-outlined />
                        subnav 3
                        </span>
                    </template>
                    <a-menu-item key="9">option9</a-menu-item>
                    <a-menu-item key="10">option10</a-menu-item>
                    <a-menu-item key="11">option11</a-menu-item>
                    <a-menu-item key="12">option12</a-menu-item>
                    </a-sub-menu>
                </a-menu>
            </a-layout-sider>

            <a-layout>
                <a-layout-content >

                    
                    <div :style="{ background: '#fff', padding: '0px', minHeight: '960px'}">
                        
                        <router-view></router-view>  

                    </div>

                </a-layout-content>
            </a-layout>


        </a-layout> -->


    

        <a-layout-content style="padding:  20px; ">
            
                <div :style="{ background: '#fff',magin:'5px', padding: '5px', minHeight: '800px',}">
                    
                        <router-view></router-view>  

                </div>
            
        </a-layout-content>
    

    
    



        <!-- åº•éƒ¨è®¾ç½®æ¡† -->
        <a-layout-footer style="text-align: center">
            Business And Social Data Analysis Teaching Platform

            <!-- æµ‹è¯•æ¿å— -->
            <!-- <div>
                <h2>ä¸´æ—¶æµ‹è¯•æ¿å—</h2>
                
                <p>ç°åœ¨çš„ç™»å½•çŠ¶æ€:{{LoginStore.status.data.IfLogin}}</p>
                <p>ç°åœ¨çš„çŠ¶æ€{{LoginStore.status.data}}</p>
                <a-button @click="LoginStore.status.data.IfLogin=!LoginStore.status.data.IfLogin">ç™»å½•</a-button>
                
                <button @click="LoginParse">æµ‹è¯•</button>

                <p>token:{{token}}</p>

                <a-radio-group v-model:value="UserType" name="radioGroup" @change="SetUserType">
                    <a-radio value="1">å­¦ç”Ÿ</a-radio>
                    <a-radio value="2">æ•™å¸ˆ</a-radio>
                    <a-radio value="3">ç®¡ç†å‘˜</a-radio>
                </a-radio-group>
                <a-divider/>

                <h2>APIæµ‹è¯•æ¿å—</h2>
                <a-input v-model:value="TestAPI" placeholder="æµ‹è¯•API"></a-input>
                <a-radio-group v-model:value="Method" name="radioGroup" >
                    <a-radio value="get">Get</a-radio>
                    <a-radio value="post">Post</a-radio>
                    <a-radio value="put">Put</a-radio>
                    <a-radio value="delete">Delete</a-radio>
                </a-radio-group>

                <a-input v-model:value="Data" placeholder="ä¼ è¾“æ•°æ®"></a-input>
                <a-radio-group v-model:value="DataType" name="radioGroup" >
                    <a-radio value='true'>å¤„ç†ä¸ºJson</a-radio>
                    <a-radio value='false'>å¤„ç†ä¸ºå­—ç¬¦ä¸²</a-radio>
                </a-radio-group>

                <a-radio-group v-model:value="TokenType" name="radioGroup" >
                    <a-radio value='true'>éœ€è¦token</a-radio>
                    <a-radio value='false'>ä¸éœ€è¦token</a-radio>
                </a-radio-group>

                <a-button @click="TestAPIFunction">APIæµ‹è¯•</a-button>


                <a-divider/>
                <a-button @click="AllDownload">æ‰¹é‡ä¸‹è½½æµ‹è¯•</a-button>


                <a-divider/>

                <a-input v-model:value="TestAPI" placeholder="æµ‹è¯•API"></a-input>
                <a-input v-model:value="Data" placeholder="ä¼ è¾“æ•°æ®"></a-input>
                <input type="file" id="TempInputFile" name="InputFiles">
                <a-button @click=" SendFiles">å‘é€æ–‡ä»¶</a-button>

            </div> -->

          </a-layout-footer>

        
    </a-layout>

    
</template>


<!-- <template>


    
    
</template> -->

<script setup>
import {ref,reactive,toRaw} from 'vue';
import index from './index.vue';
import login from './login.vue';
import {useLoginInStore} from '../Status/Store';
import { useRouter, useRoute } from 'vue-router';
import axios from 'axios';

import { UserOutlined, LaptopOutlined, NotificationOutlined } from '@ant-design/icons-vue';




const selectedKeys=ref(['']);



const selectedKeys2= ref(['1']);
const collapsed= ref(false);
const openKeys=ref(['sub1']);



// ğŸ‘‡æµ‹è¯•ç”¨

const LoginStore=useLoginInStore();

// ä»æœ¬åœ°å­˜å‚¨è·å–ç™»å½•çŠ¶æ€
LoginStore.LoginFromLocalStorage();

const UserType=ref('');

function SetUserType()
{
    LoginStore.status.data.IsStudent=(UserType.value=='1');
    LoginStore.status.data.IsTeacher=(UserType.value=='2');
    LoginStore.status.data.IsAdmin=(UserType.value=='3');
}

const token=LoginStore.status.data.Token;

// ğŸ‘‡é¡¶éƒ¨å¯¼èˆªè¿›å…¥ä¸åŒé¡µé¢Lç¼ºå°‘ç®¡ç†å‘˜çš„éƒ¨åˆ†

const router=useRouter();


const False=false;

function ToPage(){

    


    if(selectedKeys.value[0]==='Index')
    {
        router.push('/index');
        selectedKeys.value=[];
    }
    else if(!LoginStore.status.data.IfLogin)
    {
        return ;
    }
    else
    {
        

        if(LoginStore.status.data.IsStudent)
        {

            router.push('/'+selectedKeys.value[0]+'_St');
            selectedKeys.value=[];
            
        }
        else if(LoginStore.status.data.IsTeacher)
        {

            router.push('/'+selectedKeys.value[0]+'_T');
            selectedKeys.value=[];
            
        }
        else if(LoginStore.status.data.IsAdmin)
        {
            
        }
    }
}

//-----------------------------------æ§åˆ¶å°
const TestAPI=ref('');
const Method=ref('');
const Data=ref('');

const DataType=ref('');
const TokenType=ref('');



function TestAPIFunction()
{
    console.log(Method.value);
    console.log(TestAPI.value);
    console.log(DataType.value);
    console.log(TokenType.value);
    console.log(DataType.value=='true');
    console.log(TokenType.value=='true');


    // è¿™ä¸ªtrueå’Œfalseæœ‰æ—¶å€™è§£é‡Šæˆboolean,æœ‰æ—¶å€™è§£é‡Šæˆå­—ç¬¦ä¸²,å°±ä½ å—æŠ½è±¡
    const Config={
        method:Method.value,
        url:TestAPI.value,
        data: DataType.value=='true'?JSON.parse(Data.value):Data.value,
        headers: TokenType.value=='true'?{Authorization: `Bearer ${token}`}:{},
    }
    console.log(Config);

    axios.request(Config)
    .then((response)=>{
        console.log(response.data);
    })
    .catch((error)=>{
        console.log(error);
        alert('error');
    })
}



// æ‰¹é‡ä¸‹è½½
function downloadFile(url){//ä¸‹è½½æ–‡ä»¶æ–¹æ³•
	const iframe = document.createElement("iframe");
    iframe.style.display = "none";  // é˜²æ­¢å½±å“é¡µé¢
    iframe.style.height = 0;  // é˜²æ­¢å½±å“é¡µé¢
    iframe.src = url; 
    document.body.appendChild(iframe);  // è¿™ä¸€è¡Œå¿…é¡»ï¼ŒiframeæŒ‚åœ¨åˆ°domæ ‘ä¸Šæ‰ä¼šå‘è¯·æ±‚
    setTimeout(()=>{
      iframe.remove();
    }, 5 * 60 * 1000);
}

const data=['http://123.56.21.208:8002/api/Lesson/Notice_Download/18','http://123.56.21.208:8002/api/Lesson/Notice_Download/18'];

function AllDownload()
{
    data.forEach(element => {
    downloadFile(element);//å¾ªç¯è°ƒç”¨æ–¹æ³•
    });
}


function SendFiles()
{
    var File = document.getElementById('TempInputFile').files[0];
    var NewFormData = new FormData();
    console.log(Data);
    console.log(Data.value);
    var JsonFile= JSON.parse(Data.value);

    for(const i in JsonFile)
    {
        NewFormData.append(i,JsonFile[i]);
    }
    NewFormData.append("Files",File);


    axios.post(TestAPI.value,NewFormData,{
        'Content-type' : 'multipart/form-data',
        headers: {Authorization: `Bearer ${token}`},
    }).then(function (response) {
        console.log(response);
        console.log(response.data);
    })
    .catch(function (error) {
        console.log('error--------------');
        console.log(error);
        alert("Error,ä¸Šä¼ å¤±è´¥");

    });
}

</script>



<style scoped>


</style>


